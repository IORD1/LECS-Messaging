<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Faker/3.1.0/faker.min.js"
    integrity="sha512-/seDHxVfh1NvFUscAj8GsHQVZJvr2jjAoYsNL7As2FCaFHUHYIarl3sRCvVlFgyouVNiRgHIebyLKjpgd1SLDw=="
    crossorigin="anonymous"></script>
    <link rel="stylesheet" href="index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quantico&family=Silkscreen&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />

</head>

<body>
  <div class="splash">
    <div class="circle">
      Starting...
      <!-- <h1 class="fade-in">Fetching Quotes...</h1> -->
    </div>
    
  </div>



  <section id="whenSignedOut">
    <div id="head">
      <div id="p">
      <p id="p1">Linear </p><hr>
      <p id="p2">Elliptic </p><hr>
      <p id="p3">Curve </p><hr>
      <p id="p3">Signaturing </p><hr>
      <p id="p4">Messaing App</p><hr>
    </div>
      <div id="box">
        <div id="boxup">
          <button id="googleBtn" class="btn btn-primary">Sign in with Google</button>
          
        </div>
        <p class="box-down-p">signup to save your data and chat with other people </p>
        <hr>
        <div id='by-box'>
          Designed and Coded by Pratham-_-
          <p class='by-pratham'>Find here same project in React : <a href="https://github.com/IORD1" target="_blank">Github</a></p>  
        </div>
      </div>

    </div>
   

  </section>

  <section id="whenSignedIn" hidden="true">
  
  
  
    <div id="hello">
      <div id="header">
        <button id="search" class="btn btn-primary header-btn">
          <span class="material-symbols-outlined">
            search
          </span>
        </button>
        <button id="lock" class="btn btn-primary header-btn">
          <span class="material-symbols-outlined">
            lock
          </span></button>
        <button id="signOutBtn" class="btn btn-primary header-btn" onclick="func()">Sign Out</button>
        
      </div>
      
      <div id="greet">
        <div id="userDetails">
          Hello pratham
        </div>
        <div id="dp">
          <img src="" id="userdp">
        </div>
      </div>
    </div>
    

    <div id="mainpage">
          
        

      <div id="display">
        
      </div>

      <div id="footer">
        <input type="text" name="input" id="sendinput" placeholder="Write here">
        <button id="send" class="btn btn-primary send-btn">

      </div>

    </div>


  </section>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

  <script type="module">
        
      import {initializeApp} from "https://www.gstatic.com/firebasejs/9.6.9/firebase-app.js";
      import {
        getFirestore,collection,addDoc,getDocs
      } from "https://www.gstatic.com/firebasejs/9.6.9/firebase-firestore.js";
      import {
      getAuth,
      GoogleAuthProvider,
      signInWithRedirect,
      getRedirectResult,
      signInWithPopup,
      signOut
      } from "https://www.gstatic.com/firebasejs/9.6.9/firebase-auth.js";
    console.log("imported");
    
    const firebaseConfig = {
    apiKey: "AIzaSyAbEc5jQBHJ22W0Oe69Foh_kXH9iSGaf38",
    authDomain: "lecs-messaging.firebaseapp.com",
    projectId: "lecs-messaging",
    storageBucket: "lecs-messaging.appspot.com",
    messagingSenderId: "539453436104",
    appId: "1:539453436104:web:e0a5a4e793f40b04f4f5fd"
  };

  // // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const provider = new GoogleAuthProvider(app);
  const auth = getAuth(app);
// Required for side-effects

// Initialize Cloud Firestore and get a reference to the service
const db = getFirestore(app);


googleBtn.addEventListener('click', (e) => {


    signInWithPopup(auth, provider)
      .then((result) => {
        // This gives you a Google Access Token. You can use it to access the Google API.
        const credential = GoogleAuthProvider.credentialFromResult(result);
        const token = credential.accessToken;
        // The signed-in user info.
        const user = result.user;
        // name = displayName
        // email = email
        // photo = photoURL

        // ...
      }).catch((error) => {
        // Handle Errors here.
        const errorCode = error.code;
        const errorMessage = error.message;
        // The email of the user's account used.
        const email = error.email;
        // The AuthCredential type that was used.
        const credential = GoogleAuthProvider.credentialFromError(error);
        // ...
        alert(errorMessage);
      });
  });
  console.log(5);

  auth.onAuthStateChanged(user => {
    if (user) {
      // signed in
      document.getElementById("whenSignedIn").hidden = false;
      document.getElementById("whenSignedOut").hidden = true;
      document.getElementById("userDetails").innerHTML = `<p>Hello ${user.displayName.split(" ")[0]} !</p> `;
      document.getElementById("userdp").src = user.photoURL;
      console.log(user);
    } else {
      // not signed in
      document.getElementById("whenSignedIn").hidden = true;
      document.getElementById("whenSignedOut").hidden = false;
      document.getElementById("userDetails").innerHTML = '';
    }
  });

  try {
  const docRef = await addDoc(collection(db, "test"), {
    name : "kuna"
  });
  console.log("Document written with ID: ", docRef.id);
} catch (e) {
  console.error("Error adding document: ", e);
}

const querySnapshot = await getDocs(collection(db, "test"));
querySnapshot.forEach((doc) => {
  console.log(`${doc.id} => ${doc.data().name}`);
});

  document.getElementById("signOutBtn").onclick = () => auth.signOut();

  </script>
 
  <script src="app.js" defer></script>

</body>

</html>






<!-- 
<p>User ID: ${user.uid}</p> -->